# Exchange Fee Reference（交易所手续费参考表）

本文件用于统一维护各交易所的 Maker / Taker 手续费结构，作为：
- 套利预期收益计算
- 刷量成本核算
- Maker / Taker 下单策略选择
- 多交易所收益优先级排序

的重要依据。

⚠️ 注意：
- 本项目 **默认不考虑任何返佣计划**
- 所有费率均可在 `fee_config.yaml` 中 **手动覆盖**
- 实时策略逻辑 **仅依赖配置文件，不依赖本说明文档**
- 本文档仅作为"人工校验标准"和"风控参考"

---

## ✅ 1. EdgeX 永续合约

| 角色 | 费率 |
|------|------|
| Maker | **0.012%** |
| Taker | **0.038%** |

特点：
- Maker 费用极低
- 非常适合 **对冲刷量 + 被动挂单成交模型**
- 正常套利优先使用 **Maker → Maker 或 Maker → Taker 组合**

---

## ✅ 2. Backpack Exchange（Futures 永续）

### Futures Taker / Maker:

| 等级 | 30日成交量 | Maker | Taker |
|------|------------|-------|--------|
| Tier 1 | $0 | 0.020% | 0.050% |
| Tier 2 | $500,000 | 0.019% | 0.045% |
| Tier 3 | $1,000,000 | 0.018% | 0.040% |
| Tier 4 | $5,000,000 | 0.016% | 0.035% |
| Tier 5 | $10,000,000 | 0.013% | 0.030% |
| VIP1 | $25,000,000 | 0.010% | 0.026% |
| VIP2 | $50,000,000 | 0.000% | 0.024% |
| VIP3 | $75,000,000 | 0.000% | 0.022% |
| VIP4 | $100,000,000 | 0.000% | 0.020% |
| VIP5 | $150,000,000 | 0.000% | 0.018% |

策略提示：
- 普通账户阶段：刷量成本偏高
- VIP 阶段：**Maker = 0 → 可做纯 Maker 对冲套利模型**
- 非常适合后期升级为 **负手续费刷量轮动**

---

## ✅ 3. Aster 永续合约

| 角色 | 费率 |
|------|------|
| Maker | **0.0050%** |
| Taker | **0.0400%** |

特点：
- Maker 非常低
- Taker 偏高
- 适合 **Maker 主导 + Taker 对冲被动补单模型**

---

## ✅ 4. Paradex 永续合约（当前特殊政策）

| 角色 | 费率 |
|------|------|
| Maker | **0.000%（免手续费）** |
| Taker | **0.000%（免手续费）** |

额外约束：
- 当前你已启用：
  - ✅ **最大滑点限制：0.05%**
- 风险来源：
  - 滑点
  - 成交深度不足
  - 对冲失败时的单边裸露风险

策略提示：
- 极其适合 **刷量主引擎**
- 可作为 **所有刷量调度的优先撮合池**

---

## ✅ 5. GRVT 永续合约（含负手续费）

| 等级 | 30日成交量 | Maker | Taker |
|------|------------|--------|---------|
| Level 1 | - | -0.0001% | 0.045% |
| Level 2 | $100,000 | -0.0004% | 0.042% |
| Level 3 | $500,000 | -0.0008% | 0.039% |
| Level 4 | $1,000,000 | -0.0010% | 0.037% |
| Level 5 | $10,000,000 | -0.0015% | 0.034% |

特点：
- ✅ **负 Maker 手续费（返现型刷量）**
- ✅ 越刷量 → 收益越高
- ⚠️ Taker 费用仍不低

策略提示：
- 非常适合作为：
  - Maker 主刷量所
  - 成交返现主引擎
  - 与 Paradex 组合形成 "负费 + 零费" 刷量闭环

---

## ✅ 6. EXTENDED 永续合约

| 角色 | 基础费率 |
|------|----------|
| Maker | **0.000%** |
| Taker | **0.025%** |

### Maker 返佣机制（30日市占）：

| 市占比例 | Maker 返佣 |
|---------|------------|
| ≥ 0.5% | 0.0025% |
| ≥ 1.0% | 0.0050% |
| ≥ 2.5% | 0.0100% |
| ≥ 5.0% | 0.0175% |

特点：
- ✅ Maker = 0
- ✅ 市占越高 → 实际负手续费
- 非常适合 **高频 Maker 撮合策略**

---

## ✅ 7. Binance / OKX（仅作为锚定行情源）

| 平台 | Maker | Taker | 用途 |
|------|--------|--------|------|
| Binance | ~0.02% | ~0.04% | 仅用于公共行情 |
| OKX | ~0.02% | ~0.05% | 仅用于指数锚定 |

说明：
- ❌ 不参与本系统真实下单
- ✅ 仅作为：
  - 行情对比
  - 指数锚定
  - 风控偏离检测

---

## ✅ 全系统刷量与套利成本层级总结

| 等级 | 交易所 | Maker | Taker |
|------|--------|--------|--------|
| S 级（负费） | GRVT / EXTENDED | ✅ 负费 | ✅ 可接受 |
| A 级（零费） | Paradex | ✅ 0% | ✅ 0% |
| B 级（低费） | EdgeX / Aster | ✅ 0.005%~0.012% | ⚠️ 偏高 |
| C 级（中费） | Backpack | ⚠️ 0.013%~0.02% | ⚠️ 0.03%~0.05% |

---

## ✅ 后续系统实现要求（强制）

1. 所有策略禁止硬编码手续费
2. 统一通过 `FeeModel.get_fee(exchange, symbol, order_type)` 获取
3. UI 必须可手动修改各交易所的 Maker / Taker 费率
4. 风控必须支持：
   - 负手续费优先级 ← 高权重
   - Taker 成本惩罚 ← 动态惩罚因子

---

## 📝 FeeModel 配置更新建议

基于上述费率信息，建议更新 `src/perpbot/scoring/fee_model.py` 中的默认费率：

```python
DEFAULT_FEES = {
    # S 级：负手续费交易所
    "grvt": ExchangeFeeConfig(
        exchange="grvt",
        maker_fee=-0.000001,  # -0.0001% (Level 1)
        taker_fee=0.00045,    # 0.045%
    ),
    "extended": ExchangeFeeConfig(
        exchange="extended",
        maker_fee=0.0,        # 0% (基础费率，市占返佣另计)
        taker_fee=0.00025,    # 0.025%
    ),

    # A 级：零手续费交易所
    "paradex": ExchangeFeeConfig(
        exchange="paradex",
        maker_fee=0.0,        # 0%
        taker_fee=0.0,        # 0%
    ),

    # B 级：低手续费交易所
    "edgex": ExchangeFeeConfig(
        exchange="edgex",
        maker_fee=0.00012,    # 0.012%
        taker_fee=0.00038,    # 0.038%
    ),
    "aster": ExchangeFeeConfig(
        exchange="aster",
        maker_fee=0.00005,    # 0.005%
        taker_fee=0.0004,     # 0.04%
    ),

    # C 级：中等手续费交易所
    "backpack": ExchangeFeeConfig(
        exchange="backpack",
        maker_fee=0.0002,     # 0.02% (Tier 1)
        taker_fee=0.0005,     # 0.05% (Tier 1)
    ),

    # 仅用于行情参考
    "binance": ExchangeFeeConfig(
        exchange="binance",
        maker_fee=0.0002,     # 0.02%
        taker_fee=0.0004,     # 0.04%
    ),
    "okx": ExchangeFeeConfig(
        exchange="okx",
        maker_fee=0.0002,     # 0.02%
        taker_fee=0.0005,     # 0.05%
    ),
}
```

---

## 🎯 策略优化建议

### 1. 刷量优先级队列

```
S 级（负费返现） > A 级（零费） > B 级（低费 Maker） > C 级（中费）
```

### 2. 套利配对优化

**最优配对**（负费 + 零费）：
- GRVT (Maker) ↔ Paradex (Taker)
- EXTENDED (Maker) ↔ Paradex (Taker)

**次优配对**（零费 + 低费）：
- Paradex (Taker) ↔ EdgeX (Maker)
- Paradex (Taker) ↔ Aster (Maker)

**可接受配对**（低费 + 低费）：
- EdgeX (Maker) ↔ Aster (Maker)
- EdgeX (Maker) ↔ Backpack (Taker)

### 3. Maker 填单优先级

根据负费程度排序：
1. GRVT (Level 5): -0.0015%
2. EXTENDED (5% 市占): -0.0175%
3. GRVT (Level 1): -0.0001%
4. Paradex: 0%
5. Aster: 0.005%
6. EdgeX: 0.012%

---

## ⚠️ 风控注意事项

1. **负手续费风险**：
   - GRVT/EXTENDED 的负费依赖市占和等级
   - 需定期验证账户等级，防止费率突变
   - 建议设置费率告警阈值

2. **零手续费风险**：
   - Paradex 的零费政策可能随时调整
   - 需监控官方公告，及时更新配置
   - 滑点成本可能高于手续费节省

3. **深度与流动性**：
   - 负费交易所深度可能不足
   - 优先使用 Maker 模式
   - 设置合理的 max_notional 限制

4. **配置文件优先**：
   - 所有策略必须从 `fee_config.yaml` 读取费率
   - 禁止在代码中硬编码交易所费率
   - 支持热更新，无需重启服务

---

## 📅 更新记录

- **2025-12-07**: 初始版本，覆盖 7 个主要交易所
- 后续需定期验证各交易所费率变化
