# PerpBot V2 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ£€æŸ¥æ¸…å•

**ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-12-12

---

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚

- [ ] **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / Debian 11+ / CentOS 8+
- [ ] **CPU**: 4 æ ¸å¿ƒä»¥ä¸Š
- [ ] **å†…å­˜**: 8GB ä»¥ä¸Š
- [ ] **ç£ç›˜**: 50GB ä»¥ä¸Š SSD
- [ ] **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥ï¼ˆ< 50ms å»¶è¿Ÿåˆ°ä¸»è¦äº¤æ˜“æ‰€ï¼‰

### 2. è½¯ä»¶ä¾èµ–

- [ ] Docker 20.10+
- [ ] Docker Compose 2.0+
- [ ] Git
- [ ] Python 3.10+ (ç”¨äºæœ¬åœ°æµ‹è¯•)

**å®‰è£…å‘½ä»¤** (Ubuntu/Debian):
```bash
# å®‰è£… Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å®‰è£… Docker Compose
sudo apt-get install docker-compose-plugin

# éªŒè¯å®‰è£…
docker --version
docker compose version
```

### 3. å‡†å¤‡ API å‡­è¯

- [ ] **OKX**: API Key, Secret, Passphrase (æµ‹è¯•ç½‘)
- [ ] **Hyperliquid**: Account Address, Private Key (æµ‹è¯•ç½‘)
- [ ] **Paradex**: L2 Private Key, Account Address (æµ‹è¯•ç½‘)
- [ ] **å…¶ä»–äº¤æ˜“æ‰€**: æ ¹æ®éœ€è¦å‡†å¤‡

âš ï¸ **å®‰å…¨è­¦å‘Š**:
- é¦–æ¬¡éƒ¨ç½²**å¿…é¡»ä½¿ç”¨æµ‹è¯•ç½‘**
- API Key ä½¿ç”¨åªè¯»æƒé™è¿›è¡Œåˆæ­¥æµ‹è¯•
- çœŸå®äº¤æ˜“å‰ç¡®ä¿ç†è§£æ‰€æœ‰é£é™©

### 4. é…ç½®æ–‡ä»¶å‡†å¤‡

- [ ] å¤åˆ¶ `env.example` åˆ° `.env`
- [ ] å¡«å†™æ‰€æœ‰å¿…è¦çš„ API å‡­è¯
- [ ] å¤åˆ¶ `config.example.yaml` åˆ° `config.yaml`
- [ ] æ ¹æ®éœ€æ±‚è°ƒæ•´é…ç½®å‚æ•°

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### Step 1: å…‹éš†ä»“åº“

```bash
git clone https://github.com/fordxx/perp-tools.git
cd perp-tools
git checkout main  # æˆ–æŒ‡å®šåˆ†æ”¯
```

- [ ] ä»“åº“å…‹éš†æˆåŠŸ
- [ ] åˆ‡æ¢åˆ°æ­£ç¡®åˆ†æ”¯

### Step 2: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

**å¿…å¡«é¡¹æ£€æŸ¥**:
- [ ] `OKX_API_KEY`
- [ ] `OKX_API_SECRET`
- [ ] `OKX_PASSPHRASE`
- [ ] `OKX_ENV=testnet`
- [ ] `HYPERLIQUID_ACCOUNT_ADDRESS`
- [ ] `HYPERLIQUID_PRIVATE_KEY`
- [ ] `HYPERLIQUID_ENV=testnet`

**å¯é€‰é¡¹**:
- [ ] Telegram é€šçŸ¥é…ç½®
- [ ] Lark é€šçŸ¥é…ç½®

### Step 3: é…ç½®äº¤æ˜“å‚æ•°

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano config.yaml
```

**å…³é”®å‚æ•°æ£€æŸ¥**:
- [ ] `initial_capital_usdt`: åˆå§‹èµ„é‡‘ï¼ˆå»ºè®®ä» 100 USDT å¼€å§‹ï¼‰
- [ ] `max_position_size_usdt`: å•ç¬”æœ€å¤§ä»“ä½ï¼ˆå»ºè®® â‰¤ 10 USDTï¼‰
- [ ] `min_profit_bps`: æœ€å°åˆ©æ¶¦è¦æ±‚ï¼ˆå»ºè®® â‰¥ 10 bpsï¼‰
- [ ] `max_daily_loss_usdt`: æ¯æ—¥æœ€å¤§äºæŸé™åˆ¶
- [ ] `max_leverage`: æœ€å¤§æ æ†ï¼ˆå»ºè®® â‰¤ 3ï¼‰

### Step 4: æ„å»ºå’Œå¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
./deploy/scripts/start.sh
```

- [ ] Docker é•œåƒæ„å»ºæˆåŠŸ
- [ ] æ‰€æœ‰å®¹å™¨å¯åŠ¨æˆåŠŸ
- [ ] æ²¡æœ‰é”™è¯¯æ—¥å¿—

**é¢„æœŸè¾“å‡º**:
```
âœ… PerpBot V2 Started Successfully

Access points:
  ğŸ“Š Web Dashboard:  http://localhost:8000
  ğŸ“ˆ Grafana:        http://localhost:3000
  ğŸ” Prometheus:     http://localhost:9090
```

### Step 5: éªŒè¯æœåŠ¡å¥åº·

```bash
# è¿è¡Œå¥åº·æ£€æŸ¥
./deploy/scripts/health-check.sh
```

**æ£€æŸ¥é¡¹**:
- [ ] âœ… PerpBot: HEALTHY
- [ ] âœ… Prometheus: HEALTHY
- [ ] âœ… Grafana: HEALTHY
- [ ] âœ… Redis: HEALTHY

### Step 6: è®¿é—® Web Dashboard

```bash
# åœ¨æµè§ˆå™¨æ‰“å¼€
open http://localhost:8000
```

**æ£€æŸ¥é¡¹**:
- [ ] Dashboard å¯ä»¥è®¿é—®
- [ ] æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€
- [ ] æ˜¾ç¤ºäº¤æ˜“æ‰€è¿æ¥çŠ¶æ€
- [ ] æ˜¾ç¤ºèµ„é‡‘ä¿¡æ¯

### Step 7: æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹ PerpBot ä¸»æ—¥å¿—
./deploy/scripts/logs.sh perpbot

# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker compose logs -f
```

**æ£€æŸ¥é¡¹**:
- [ ] æ²¡æœ‰ ERROR çº§åˆ«æ—¥å¿—
- [ ] WebSocket è¿æ¥æˆåŠŸ
- [ ] è¡Œæƒ…æ•°æ®æ­£å¸¸æ¥æ”¶

---

## ğŸ” éªŒè¯æµ‹è¯•

### 1. WebSocket è¿æ¥æµ‹è¯•

```bash
# æµ‹è¯• WebSocket è¿æ¥
python test_websocket_feeds.py
```

**é¢„æœŸç»“æœ**:
- [ ] OKX WebSocket è¿æ¥æˆåŠŸ
- [ ] Hyperliquid WebSocket è¿æ¥æˆåŠŸ
- [ ] æ”¶åˆ°å®æ—¶è¡Œæƒ…æ•°æ®
- [ ] å»¶è¿Ÿ < 100ms

### 2. å¥—åˆ©æ‰«ææµ‹è¯•

```bash
# è¿è¡Œå¥—åˆ©æ‰«æ Demo
python demos/websocket_arbitrage_demo.py
```

**é¢„æœŸç»“æœ**:
- [ ] æ‰«æå™¨å¯åŠ¨æˆåŠŸ
- [ ] å‘ç°å¥—åˆ©æœºä¼šï¼ˆå¦‚æœå¸‚åœºæ¡ä»¶å…è®¸ï¼‰
- [ ] è®¡ç®—å‡€åˆ©æ¶¦æ­£ç¡®
- [ ] æ²¡æœ‰å´©æºƒæˆ–é”™è¯¯

### 3. ç³»ç»ŸéªŒè¯

```bash
# è¿è¡Œå®Œæ•´ç³»ç»ŸéªŒè¯
python validate_perpbot_v2.py
```

**é¢„æœŸç»“æœ**:
- [ ] éªŒè¯åˆ†æ•° â‰¥ 99/100
- [ ] æ‰€æœ‰æ ¸å¿ƒæ¨¡å—é€šè¿‡æµ‹è¯•
- [ ] æ²¡æœ‰é˜»å¡æ€§é”™è¯¯

---

## ğŸ“Š ç›‘æ§é…ç½®

### 1. Grafana Dashboard

è®¿é—®: http://localhost:3000
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin` (é¦–æ¬¡ç™»å½•åä¿®æ”¹)

**é…ç½®æ£€æŸ¥**:
- [ ] Prometheus æ•°æ®æºé…ç½®æˆåŠŸ
- [ ] PerpBot Dashboard æ˜¾ç¤ºæ­£å¸¸
- [ ] å®æ—¶æ•°æ®æ›´æ–°

### 2. Prometheus æŒ‡æ ‡

è®¿é—®: http://localhost:9090

**æ£€æŸ¥æŒ‡æ ‡**:
- [ ] `perpbot_system_health` > 0.9
- [ ] `perpbot_websocket_connected{exchange="okx"}` == 1
- [ ] `perpbot_capital_utilization_percent` < 80
- [ ] `perpbot_orders_total` åœ¨å¢é•¿ï¼ˆå¦‚æœæœ‰äº¤æ˜“ï¼‰

### 3. Alertmanager å‘Šè­¦

è®¿é—®: http://localhost:9093

**é…ç½®æ£€æŸ¥**:
- [ ] æ²¡æœ‰æ´»è·ƒçš„ Critical å‘Šè­¦
- [ ] å‘Šè­¦è§„åˆ™åŠ è½½æˆåŠŸ
- [ ] Webhook é…ç½®æ­£ç¡®

---

## ğŸ” å®‰å…¨æ£€æŸ¥

### 1. å‡­è¯å®‰å…¨

- [ ] `.env` æ–‡ä»¶æƒé™è®¾ç½®ä¸º 600
  ```bash
  chmod 600 .env
  ```
- [ ] `.env` å·²æ·»åŠ åˆ° `.gitignore`
- [ ] æ²¡æœ‰å°†å‡­è¯æäº¤åˆ° Git
- [ ] API Key ä½¿ç”¨æœ€å°æƒé™

### 2. ç½‘ç»œå®‰å…¨

- [ ] é˜²ç«å¢™é…ç½®æ­£ç¡®
- [ ] åªæš´éœ²å¿…è¦çš„ç«¯å£
- [ ] ä½¿ç”¨ HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] é™åˆ¶ Dashboard è®¿é—®ï¼ˆIP ç™½åå•ï¼‰

### 3. å®¹å™¨å®‰å…¨

- [ ] å®¹å™¨ä»¥é root ç”¨æˆ·è¿è¡Œ
- [ ] å®¹å™¨èµ„æºé™åˆ¶é…ç½®
- [ ] å®šæœŸæ›´æ–° Docker é•œåƒ
- [ ] æ‰«æé•œåƒæ¼æ´

---

## ğŸ¯ ç”Ÿäº§ç¯å¢ƒé¢å¤–æ£€æŸ¥

### 1. é«˜å¯ç”¨æ€§

- [ ] é…ç½®å®¹å™¨è‡ªåŠ¨é‡å¯ç­–ç•¥
- [ ] é…ç½®å¥åº·æ£€æŸ¥
- [ ] å‡†å¤‡æ•…éšœæ¢å¤è®¡åˆ’
- [ ] é…ç½®æ•°æ®å¤‡ä»½

### 2. æ€§èƒ½ä¼˜åŒ–

- [ ] è°ƒæ•´ Docker èµ„æºé™åˆ¶
- [ ] ä¼˜åŒ–æ•°æ®åº“è¿æ¥æ± 
- [ ] é…ç½® Redis ç¼“å­˜
- [ ] ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨

### 3. åˆè§„æ€§

- [ ] äº†è§£å½“åœ°äº¤æ˜“æ³•è§„
- [ ] é…ç½®äº¤æ˜“æ—¥å¿—è®°å½•
- [ ] å‡†å¤‡å®¡è®¡æŠ¥å‘Š
- [ ] é£é™©æŠ«éœ²æ–‡æ¡£

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: æœåŠ¡æ— æ³•å¯åŠ¨

**æ£€æŸ¥**:
1. ç«¯å£æ˜¯å¦è¢«å ç”¨ (`netstat -tlnp | grep :8000`)
2. Docker æœåŠ¡æ˜¯å¦è¿è¡Œ (`systemctl status docker`)
3. ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³ (`df -h`)
4. å†…å­˜æ˜¯å¦è¶³å¤Ÿ (`free -h`)

### Q2: WebSocket è¿æ¥å¤±è´¥

**æ£€æŸ¥**:
1. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
2. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢å‡ºç«™è¿æ¥
3. API å‡­è¯æ˜¯å¦æ­£ç¡®
4. äº¤æ˜“æ‰€æ˜¯å¦ç»´æŠ¤ä¸­

### Q3: æ•°æ®ä¸æ›´æ–°

**æ£€æŸ¥**:
1. WebSocket è¿æ¥çŠ¶æ€
2. Prometheus æ˜¯å¦æ­£å¸¸æŠ“å–æ•°æ®
3. æ—¶é—´åŒæ­¥æ˜¯å¦æ­£ç¡® (`timedatectl`)
4. æ—¥å¿—ä¸­æ˜¯å¦æœ‰é”™è¯¯

### Q4: å†…å­˜å ç”¨è¿‡é«˜

**è§£å†³æ–¹æ¡ˆ**:
1. å‡å°‘è®¢é˜…çš„äº¤æ˜“å¯¹æ•°é‡
2. è°ƒæ•´æ—¥å¿—çº§åˆ«åˆ° WARNING
3. å¢åŠ æœåŠ¡å™¨å†…å­˜
4. é‡å¯æœåŠ¡é‡Šæ”¾å†…å­˜

---

## ğŸ“ æ”¯æŒ

é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ—¥å¿—**: `./deploy/scripts/logs.sh perpbot`
2. **æŸ¥çœ‹æ–‡æ¡£**: [docs/](../docs/)
3. **è¿è¡ŒéªŒè¯**: `python validate_perpbot_v2.py`
4. **æäº¤ Issue**: [GitHub Issues](https://github.com/fordxx/perp-tools/issues)

---

## âœ… éƒ¨ç½²å®Œæˆç¡®è®¤

åœ¨å¼€å§‹çœŸå®äº¤æ˜“å‰ï¼Œç¡®è®¤ä»¥ä¸‹æ‰€æœ‰é¡¹éƒ½å·²å®Œæˆï¼š

- [ ] æ‰€æœ‰æœåŠ¡å¥åº·è¿è¡Œ
- [ ] WebSocket è¿æ¥ç¨³å®š
- [ ] ç›‘æ§ç³»ç»Ÿé…ç½®å®Œæˆ
- [ ] å‘Šè­¦ç³»ç»Ÿæµ‹è¯•é€šè¿‡
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸
- [ ] å·²è¿›è¡Œ 24 å°æ—¶æµ‹è¯•è¿è¡Œ
- [ ] ç†è§£æ‰€æœ‰é£é™©å’Œé™åˆ¶
- [ ] å‡†å¤‡å¥½ç´§æ€¥åœæ­¢è®¡åˆ’

**ç­¾å**: _______________
**æ—¥æœŸ**: _______________

---

**âš ï¸ é‡è¦æé†’**: å³ä½¿å®Œæˆæ‰€æœ‰æ£€æŸ¥ï¼ŒçœŸå®äº¤æ˜“ä»å­˜åœ¨æé«˜é£é™©ã€‚å»ºè®®ä»æå°é‡‘é¢ï¼ˆ1-10 USDTï¼‰å¼€å§‹æµ‹è¯•ï¼Œå¹¶æŒç»­ç›‘æ§è‡³å°‘ä¸€å‘¨åå†å¢åŠ èµ„é‡‘è§„æ¨¡ã€‚
